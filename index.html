<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard de Ventas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #192841, #1c2c4d);
      color: white; padding:20px;
    }
    h1 { margin-bottom:10px; text-align:center; }
    .dashboard {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      gap:20px;
    }
#campa√±asActivas {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

#campa√±asActivas .card {
  width: 100%;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  padding: 1rem;
  background-color: white;
  border-radius: 12px;
}

#campa√±asActivas .metrics {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin-top: 1rem;
}

#campa√±asActivas .metric {
  flex: 1 1 150px;
  min-width: 120px;
}

#campa√±asActivas h3 {
  margin: 0;
  font-size: 1.2rem;
  color: #334;
}

    .card {
      background:#23395b;
      border-radius:12px;
      padding:20px;
      box-shadow:0 0 10px rgba(0,0,0,0.2);
    }
    .card h3 { margin-top:0; color:#88a91e; font-size:1.3rem; text-align:center; }
    canvas { width:100%!important; height:auto!important; }
    .metrics { display:flex; justify-content:space-between; flex-wrap:wrap; gap:10px; }
    .metric {
      flex:1 1 100px;
      background:#2d456b;
      padding:10px;
      border-radius:8px;
      text-align:center;
    }
    .metric-value { font-size:1.5rem; color:#88a91e; }
    #enableAudio {
      padding:10px 20px;
      background:linear-gradient(to right,#6a11cb,#2575fc);
      color:white; border:none; border-radius:8px;
      font-size:1rem; cursor:pointer;
      display:block; margin:10px auto;
    }
    #personajeContenedor {
      position:fixed; bottom:20px; right:20px;
      width:120px; text-align:center; z-index:9999;
    }
    #personaje { width:100px; animation:bob 3s ease-in-out infinite; }
    #nube {
      position:absolute; top:-60px; right:0;
      background:rgba(255,255,255,0.9);
      color:#222; padding:8px 12px;
      border-radius:12px; font-size:0.85rem;
      animation:fadeInOut 5s infinite;
    }
    @keyframes bob { 0%,100% { transform:translateY(0); } 50% { transform:translateY(-10px); } }
    @keyframes fadeInOut { 0%,100% {opacity:1;} 45%,55% {opacity:0.3;} }
    @media(max-width:768px){
      .dashboard { grid-template-columns:1fr; }
      #personajeContenedor { bottom:10px; right:10px; }
    }
  </style>
</head>
<body>

<h1>üìä Dashboard de Ventas</h1>
<button id="enableAudio">üîä Activar Audio</button>

<div class="dashboard">
  <div class="card">
    <h3>Resumen de Pedidos</h3>
    <div class="metrics">
      <div class="metric"><div class="metric-value" id="totalPedidos">0</div><div>Total Pedidos</div></div>
      <div class="metric"><div class="metric-value" id="ventasHoy">$0</div><div>Ventas Hoy</div></div>
      <div class="metric"><div class="metric-value" id="ticketPromedio">$0</div><div>Ticket Promedio</div></div>
      <div class="metric"><div class="metric-value" id="pedidosHoy">0</div><div>Pedidos Hoy</div></div>
    </div>
  </div>
  <div class="card"><h3>Pedidos por D√≠a</h3><canvas id="graficaPedidos"></canvas></div>
  <div class="card"><h3>Proyecci√≥n</h3><canvas id="graficaProyeccion"></canvas></div>
  <div class="card"><h3>Top Clientes</h3><canvas id="graficaClientes"></canvas></div>
  <div class="card"><h3>Top Productos</h3><canvas id="graficaProductos"></canvas></div>
  <div class="card"><h3>Clientes Nuevos vs Recurrentes</h3><canvas id="graficaNuevosVsRecurrentes"></canvas></div>
  <div class="card"><h3>Productos de Baja Rotaci√≥n</h3><canvas id="graficaBajaRotacion"></canvas></div>
</div>

<!-- Personaje animado -->
<div id="personajeContenedor">
  <div id="nube">Esperando pedido...</div>
  <img id="personaje" src="https://i.imgur.com/UQ5yX5L.png" alt="Personaje">
</div>

<!-- Audios -->
<audio id="audio1" src="https://cdn.shopify.com/s/files/1/0945/7555/8941/files/Rappi_SONIDO_de_RAPPI_cuando_llega_un_PEDIDO_-_Sonidos_mp3cut.net.mp3" preload="auto"></audio>
<audio id="audio2" src="https://cdn.shopify.com/s/files/1/0945/7555/8941/files/eso-rony_mp3cut.net.mp3" preload="auto"></audio>
<audio id="audio3" src="https://cdn.shopify.com/s/files/1/0945/7555/8941/files/ssstik_mp3cut.net.mp3" preload="auto"></audio>
<audio id="audio4" src="https://cdn.shopify.com/s/files/1/0945/7555/8941/files/ssstik_mp3cut.net_1.mp3" preload="auto"></audio>

<script>
const sheetId = '1hgdNPwXGJijXfv8FlE4RUNCGl-fkoJ-qheCxfZ7pEjM';
const sheetRange = 'Pedidos';
const apiKey = 'AIzaSyB3df7vOH8RMvrhzbfmxLq61o51Eve9tto';
const sheetUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetRange}?key=${apiKey}`;

let lastCount = -1, audioEnabled = false, lastOrderTime = Date.now();

const sonidos = [
  document.getElementById('audio1'),
  document.getElementById('audio2'),
  document.getElementById('audio3'),
  document.getElementById('audio4')
];

document.getElementById('enableAudio').onclick = () => {
  audioEnabled = !audioEnabled;
  document.getElementById('enableAudio').textContent = audioEnabled ? '‚úÖ Sonido Activado' : 'üîä Activar Audio';
};

  const updateCharacter = () => {
    const nube = document.getElementById('nube');
    const personaje = document.getElementById('personaje');
    const elapsed = (Date.now() - lastOrderTime) / 1000;

    if (elapsed < 1) {
      personaje.src = 'https://media.tenor.com/Frr96mV2EVAAAAAM/futurama-philip-j-fry.gif'; // feliz
      nube.textContent = '¬°Pedido recibido!';
    } else if (elapsed < 20) {
      personaje.src = 'https://c.tenor.com/QwtWEi13MtAAAAAd/tenor.gif'; // normal
      nube.textContent = 'Esperando pedido...';
    } else if (elapsed < 40) {
      personaje.src = 'https://media.tenor.com/ApxBu1krFnIAAAAM/shaking-twitch.gif'; // con caf√©
      nube.textContent = 'Uy, me voy por un caf√©...';
    } else {
      personaje.src = 'https://media.tenor.com/ZGbjiPpgQfcAAAAM/sleeping-fry.gif'; // dormido
      nube.textContent = 'Ya casi me duermo‚Ä¶';
    }
  };
setInterval(updateCharacter, 1000);

const formatearMoneda = n => parseInt(n).toLocaleString('es-CO');

const celebrarPedido = (cliente, monto) => {
  if (!audioEnabled) return;
  confetti({ particleCount:200, spread:100, origin:{y:0.6} });
  const audio = sonidos[Math.floor(Math.random()*sonidos.length)];
  audio.pause(); audio.currentTime=0;
  audio.play().then(() => {
    const msg = new SpeechSynthesisUtterance(`Nuevo pedido de ${cliente} por ${formatearMoneda(monto)} pesos.`);
    msg.lang='es-CO'; window.speechSynthesis.speak(msg);
  });
  lastOrderTime = Date.now();
};

const destroyChart = id => {
  const old = document.getElementById(id);
  const nc = old.cloneNode();
  old.parentNode.replaceChild(nc, old);
  return nc.getContext('2d');
};

async function fetchData(){
  try {
    const res = await fetch(sheetUrl);
    const rows = (await res.json()).values?.slice(1) || [];

    const today = new Date().toISOString().split('T')[0];
    let total=0, totalToday=0, countToday=0, nuevoCliente='', nuevoMonto=0;
    const pedidosDiarios={}, clientes={}, productos={}, nuevos={}, recurrentes={}, bajaRotacion={};


rows.forEach((r,i)=>{
  if(r.length<7) return;
  const [fechaRaw, cliente,,,, totalVenta, producto] = r;
  const fecha = (fechaRaw || '').trim().split(' ')[0]; // ‚Üê Asegura que solo uses la parte "YYYY-MM-DD"
  const monto = parseFloat(totalVenta.replace(/[^\d.]/g,''))||0;

  if(!fecha||!cliente||!monto) return;

  total++;
  pedidosDiarios[fecha] = (pedidosDiarios[fecha]||0)+1;
  ...
  if(fecha === today){
    totalToday += monto;
    countToday++;
  }
});
      // nuevos vs recurrentes
      if(!nuevos[cliente] && recurrentes[cliente]===undefined){
        nuevos[cliente] = 1;
      } else {
        recurrentes[cliente] = (recurrentes[cliente]||0)+1;
      }
      // baja rotaci√≥n: menos de 2 vendidos
      producto.split(',').forEach(p=>{
        const it=p.trim();
        if(it) bajaRotacion[it]=(bajaRotacion[it]||0)+1;
      });
      if(i === rows.length-2){
        nuevoCliente = cliente;
        nuevoMonto = monto;
      }
    });
    const ticket = totalToday/(countToday||1);
    document.getElementById('totalPedidos').textContent = total;
    document.getElementById('ventasHoy').textContent = '$'+formatearMoneda(totalToday);
    document.getElementById('ticketPromedio').textContent = '$'+formatearMoneda(ticket);
    document.getElementById('pedidosHoy').textContent = countToday;
    if(total > lastCount){
      celebrarPedido(nuevoCliente, nuevoMonto);
      lastCount = total;
    }

    new Chart(destroyChart('graficaPedidos'), {
      type:'bar',
      data:{labels:Object.keys(pedidosDiarios), datasets:[{label:'Pedidos/d√≠a', data:Object.values(pedidosDiarios), backgroundColor:'#88a91e'}]},
      options:{scales:{y:{beginAtZero:true}}}
    });
    new Chart(destroyChart('graficaProyeccion'), {
      type:'line',
      data:{labels:Object.keys(pedidosDiarios), datasets:[{label:'Proyecci√≥n', data:Object.values(pedidosDiarios).map(v=>v*ticket), fill:true, borderColor:'#34d399', backgroundColor:'rgba(52,211,153,0.2)'}]},
      options:{scales:{y:{beginAtZero:true}}}
    });
    new Chart(destroyChart('graficaClientes'), {
      type:'bar',
      data:{labels:Object.keys(clientes), datasets:[{label:'Clientes', data:Object.values(clientes), backgroundColor:'rgba(131,88,255,0.8)'}]},
      options:{indexAxis:'y', scales:{x:{beginAtZero:true}}}
    });
    new Chart(destroyChart('graficaProductos'), {
      type:'bar',
      data:{labels:Object.keys(productos), datasets:[{label:'Productos', data:Object.values(productos), backgroundColor:'rgba(0,200,255,0.6)'}]},
      options:{indexAxis:'y', scales:{x:{beginAtZero:true}}}
    });
    // nuevos vs recurrentes
    new Chart(destroyChart('graficaNuevosVsRecurrentes'), {
      type:'pie',
      data:{
        labels:['Nuevos','Recurrentes'],
        datasets:[{data:[Object.keys(nuevos).length, Object.keys(recurrentes).length], backgroundColor:['#4ade80','#16a34a']}]
      }
    });
    // baja rotaci√≥n (menos de 2)
    const baja = Object.entries(bajaRotacion).filter(([k,v])=>v<2).reduce((a,[k,v])=>(a.labels.push(k), a.data.push(v),a),{labels:[],data:[]});
    new Chart(destroyChart('graficaBajaRotacion'), {
      type:'bar',
      data:{labels:baja.labels, datasets:[{label:'Ventas bajas',data:baja.data, backgroundColor:'#f87171'}]},
      options:{indexAxis:'y', scales:{x:{beginAtZero:true}}}
    });

  } catch(err){console.error('Error datos:',err);}
}

setInterval(fetchData,5000);
fetchData();

</script>
<h2 style="margin-top:40px; text-align:center; color:#88a91e;">üì£ Campa√±as Activas</h2>
<div id="campa√±asActivas" class="dashboard" style="margin-top:20px;"></div>

<script>
// ID y rango de la hoja de campa√±as
const sheetCampa√±asId = '12onwt2yOZMlBSKIWHz4wR2NK5oqWiWtzyrMIhJt3L9k';
const sheetCampa√±asRange = 'FacebookAds';
const sheetCampa√±asUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetCampa√±asId}/values/${sheetCampa√±asRange}?key=${apiKey}`;

function formatearCO(valor) {
  const num = parseFloat(valor.toString().replace(/[^\d.-]/g, ''));
  if (isNaN(num)) return valor;
  return '$' + num.toLocaleString('es-CO');
}
function generarRecomendaciones(valores) {
  const get = campo => parseFloat((valores.find(v => v.campo === campo)?.valor || '0').toString().replace(',', '.')) || 0;

  const frecuencia = get('Frecuencia');
  const ctr = get('CTR');
  const compras = get('Compras');
  const gasto = get('Gasto');
  const cpc = get('CPC');
  const roas = get('ROAS');
  const cpa = get('CPA'); // esto ya hace un parseFloat si usas tu funci√≥n get()
  const cpm = get('CPM');
  const impresiones = get('Impresiones');
  const alcance = get('Alcance');
  const inicios_de_pago = get('Inicios de pago');
  const costo_por_inicio_de_pago = get('Costo por inicio de pago');
  const valor_de_compras = get('Valor de compras');

  const recomendaciones = [];

if (cpa > 20000 && compras === 0) recomendaciones.push("üö® CPA muy alto y sin compras. Diagn√≥stico: mala conversi√≥n. ‚öôÔ∏è Considera pausar o lanzar una nueva campa√±a con otro p√∫blico.");
if (cpa > 15000 && ctr < 1 && frecuencia > 3) recomendaciones.push("üìâ CPA sobre el l√≠mite, CTR bajo y frecuencia alta. ‚öôÔ∏è Redise√±a creativos y prueba p√∫blicos fr√≠os.");
if (cpa <= 15000 && compras > 10 && roas > 2) recomendaciones.push("üìà CPA saludable, buen volumen de compras y ROAS alto. üöÄ Escala agresivamente.");
if (ctr > 2 && cpc < 800 && cpa < 15000 && compras > 20) recomendaciones.push("üìà CTR excelente, CPC bajo y CPA ideal. üöÄ Recomendaci√≥n: escalar agresivamente esta campa√±a.");
if (alcance < 1000 && cpa > 20000) recomendaciones.push("üîç Alcance bajo y CPA alto. ‚öôÔ∏è Ampl√≠a audiencia o cambia la segmentaci√≥n.");
if (cpc > 2000 && ctr < 0.8) recomendaciones.push("üìâ CPC muy alto y CTR muy bajo. ‚öôÔ∏è Recomendaci√≥n: cambia copy e imagen. P√∫blico probablemente agotado.");
if (cpa < 12000 && frecuencia < 2 && roas > 3) recomendaciones.push("üìà CPA excelente, frecuencia controlada y ROAS alto. üöÄ Escala gradualmente monitoreando rendimiento.");
if (inicios_de_pago > 10 && compras === 0) recomendaciones.push("üîç Muchos inicios de pago pero sin compras. ‚öôÔ∏è Verifica problemas en checkout o tracking de conversiones.");
if (impresiones < 1000 && cpc > 1500 && ctr < 1) recomendaciones.push("üìâ Pocas impresiones, CPC costoso y CTR bajo. ‚öôÔ∏è Revisa calidad del anuncio y prueba nuevas creatividades.");
if (roas < 1 && cpa > 20000) recomendaciones.push("üö® ROAS negativo y CPA fuera de control. ‚öôÔ∏è Pausa campa√±a y replantea p√∫blico y objetivo.");
if (compras > 20 && roas > 2.5 && frecuencia < 3) recomendaciones.push("üìà Compras altas, ROAS excelente y frecuencia estable. üöÄ Escala progresivamente con +20% presupuesto.");
if (frecuencia > 4 && ctr < 1) recomendaciones.push("üìâ Frecuencia alta con bajo CTR. ‚öôÔ∏è Anuncio quemado. Cambia dise√±o o mensaje urgente.");
if (cpc < 1000 && cpa < 15000 && compras > 5) recomendaciones.push("üìà Buen CPC y CPA, con compras constantes. üìà Escala gradualmente y monitorea ROAS.");
if (impresiones > 5000 && compras === 0) recomendaciones.push("üîç Buenas impresiones sin resultados. ‚öôÔ∏è Verifica el mensaje, posible desconexi√≥n con el p√∫blico.");
if (gasto > 80000 && cpa > 20000 && compras < 3) recomendaciones.push("üö® Mucho gasto con resultados pobres. ‚öôÔ∏è Det√©n o relanza campa√±a con nuevo enfoque.");
if (alcance > 5000 && frecuencia > 5 && cpa > 20000) recomendaciones.push("üìâ Saturaci√≥n de audiencia. ‚öôÔ∏è Cambia a p√∫blico fresco o expande segmentaci√≥n.");
if (inicios_de_pago === 0 && cpa > 15000 && ctr < 1) recomendaciones.push("üìâ Sin inicios de pago, CPA alto y CTR bajo. ‚öôÔ∏è Prueba oferta m√°s clara o beneficio directo.");
if (compras > 10 && cpa < 13000 && cpc < 1200) recomendaciones.push("üìà Compras saludables, CPA y CPC bajo. üöÄ Escala agresivamente si presupuesto lo permite.");
if (compras === 0 && ctr < 0.7 && gasto > 30000) recomendaciones.push("üìâ CTR muy bajo sin resultados. ‚öôÔ∏è Det√©n anuncio y redise√±a creatividades.");
if (roas > 3 && frecuencia < 2.5 && cpa < 12000) recomendaciones.push("üöÄ ROAS alto, frecuencia controlada y CPA excelente. Escalamiento recomendado.");
if (ctr < 0.8 && cpa > 18000) recomendaciones.push("üìâ CTR bajo y CPA elevado. ‚öôÔ∏è Mejora el copy o prueba un nuevo gancho.");
if (frecuencia > 4 && compras < 3) recomendaciones.push("üìâ Frecuencia alta sin suficientes compras. ‚öôÔ∏è Creativo agotado. C√°mbialo o reduce el presupuesto.");
if (cpc > 1800 && ctr < 1) recomendaciones.push("‚ö†Ô∏è CPC elevado y bajo CTR. ‚öôÔ∏è Segmentaci√≥n poco efectiva. Considera otro p√∫blico.");
if (compras > 15 && roas > 2.5 && cpa < 14000) recomendaciones.push("üöÄ Buenas compras, ROAS alto y CPA bajo. Escala gradualmente.");
if (cpa > 20000 && impresiones > 5000 && compras < 3) recomendaciones.push("üìâ Muchas impresiones, CPA elevado y sin resultados. ‚öôÔ∏è Prueba otro mensaje y segmentaci√≥n.");
if (compras === 0 && cpc > 2000 && gasto > 40000) recomendaciones.push("üìâ Sin compras, CPC caro y gasto alto. ‚öôÔ∏è Pausa y relanza con nuevo p√∫blico.");
if (ctr > 2.5 && cpa < 15000 && compras > 10) recomendaciones.push("üìà CTR excelente, CPA √≥ptimo. üöÄ Escalar con +20% presupuesto recomendado.");
if (frecuencia > 5 && ctr < 0.7) recomendaciones.push("‚ö†Ô∏è Frecuencia excesiva y CTR muy bajo. ‚öôÔ∏è Anuncio quemado. Actualiza contenido.");
if (alcance < 1500 && gasto > 30000 && compras < 2) recomendaciones.push("üìâ Poco alcance, gasto alto y sin resultados. ‚öôÔ∏è Ampl√≠a audiencia.");
if (cpm > 4000 && ctr < 1 && roas < 1) recomendaciones.push("üìâ CPM alto, CTR bajo y ROAS negativo. ‚öôÔ∏è Cambia enfoque creativo y p√∫blico.");
if (valor_de_compras > 100000 && roas > 2 && cpa < 15000) recomendaciones.push("üìà Buen retorno y CPA saludable. üöÄ Escala con presupuesto m√°s agresivo.");
if (compras > 25 && roas > 3) recomendaciones.push("üöÄ Alto volumen de compras y excelente ROAS. Escalamiento agresivo recomendado.");
if (compras === 0 && inicios_de_pago > 10) recomendaciones.push("üîç Muchos inicios de pago pero sin compras. ‚öôÔ∏è Verifica checkout, posibles fricciones.");
if (ctr < 0.5 && cpm > 3000) recomendaciones.push("‚ö†Ô∏è CTR muy bajo y CPM alto. ‚öôÔ∏è Segmentaci√≥n ineficiente o anuncio poco atractivo.");
if (cpc < 1000 && ctr > 2 && cpa < 12000) recomendaciones.push("üìà Anuncio muy eficiente. üöÄ Escala agresivamente.");
if (frecuencia > 4 && cpa > 20000 && roas < 1) recomendaciones.push("üìâ Saturaci√≥n y mal rendimiento. ‚öôÔ∏è Pausar y replantear campa√±a.");
if (gasto > 100000 && compras < 5) recomendaciones.push("üö® Gasto alto con bajas conversiones. ‚öôÔ∏è Detener y redise√±ar estrategia.");
if (alcance > 10000 && compras === 0) recomendaciones.push("‚ö†Ô∏è Alcance amplio sin resultados. ‚öôÔ∏è P√∫blico no est√° conectado con la oferta.");
if (inicios_de_pago === 0 && ctr < 1 && cpm > 3000) recomendaciones.push("üìâ Sin intenci√≥n de compra, CTR y CPM ineficientes. ‚öôÔ∏è Redise√±a la oferta y segmentaci√≥n.");
if (compras > 20 && cpa < 13000 && roas > 2.8) recomendaciones.push("üöÄ Muy buen rendimiento. Escala esta campa√±a con confianza.");
if (compras < 2 && cpa > 25000) recomendaciones.push("üö® Campa√±a ineficiente. ‚öôÔ∏è Detener y analizar audiencias.");
if (cpc > 2000 && frecuencia > 4 && ctr < 0.8) recomendaciones.push("üìâ Costo alto, saturaci√≥n y poco inter√©s. ‚öôÔ∏è Creativo agotado.");
if (valor_de_compras > 150000 && cpa > 20000) recomendaciones.push("‚ö†Ô∏è Buen ingreso total pero CPA elevado. ‚öôÔ∏è Optimiza estructura de anuncios.");
if (gasto < 20000 && roas > 3) recomendaciones.push("üìà Buen ROAS con poco gasto. üìà Considera escalar con +10%.");
if (cpa >= 14000 && cpa <= 16000 && roas > 2) { recomendaciones.push("üìà CPA cerca del l√≠mite pero con buen ROAS. üìà Escalar gradualmente vigilando."); }
if (compras > 5 && inicios_de_pago > 15 && cpc < 1200) recomendaciones.push("üìà Buen engagement y compras. üöÄ Escalamiento viable.");
if (roas < 1 && cpa > 25000) recomendaciones.push("üö® Muy bajo retorno. ‚öôÔ∏è Redireccionar presupuesto.");
if (ctr < 1 && compras === 0 && gasto > 30000) recomendaciones.push("üìâ Sin rendimiento y sin clics. ‚öôÔ∏è Anuncio irrelevante.");
if (frecuencia > 6 && cpc > 1800) recomendaciones.push("üìâ Saturaci√≥n de anuncio con CPC alto. ‚öôÔ∏è Redise√±a urgente.");
if (cpa < 12000 && compras > 10) recomendaciones.push("üìà CPA excelente con buenas compras. üöÄ Recomendaci√≥n: escalar con confianza.");
if (compras === 0 && ctr > 2) recomendaciones.push("üîç CTR alto sin compras. ‚öôÔ∏è Problemas en el sitio o en el checkout.");
if (roas > 3 && compras > 20) recomendaciones.push("üöÄ Muy buena campa√±a. Escala agresivamente con duplicaci√≥n.");
if (gasto > 60000 && compras === 0) recomendaciones.push("üö® Gasto sin resultados. ‚öôÔ∏è Replantea mensaje o p√∫blico.");
if (inicios_de_pago > 5 && cpc < 1000 && compras < 2) recomendaciones.push("üîç Buena intenci√≥n pero no cierra ventas. ‚öôÔ∏è Revisa la p√°gina de producto.");
if (cpa >= 15000 && cpa <= 18000 && roas >= 1.5 && roas <= 2.5) { recomendaciones.push("üìà CPA algo elevado pero ROAS viable. üìà Escalar moderadamente."); }
if (cpm < 2000 && ctr < 1) recomendaciones.push("üìâ CPM bueno pero poco inter√©s. ‚öôÔ∏è Cambia el enfoque del anuncio.");
if (frecuencia > 3.5 && compras > 10) recomendaciones.push("üìà Resultados buenos, pero evita saturaci√≥n. üìà Escala solo si rendimiento contin√∫a.");
if (alcance < 1000 && cpa < 15000) recomendaciones.push("üìà Poco alcance pero CPA bueno. üìà Escala para probar con m√°s datos.");
if (valor_de_compras < 50000 && cpa > 20000) recomendaciones.push("üìâ Ingreso bajo con CPA caro. ‚öôÔ∏è Ajusta tu funnel.");
if (compras > 30 && roas > 3.5 && frecuencia < 3) recomendaciones.push("üöÄ Excelente rendimiento general. Escala agresivo duplicando.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [21] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [22] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (cpm < 1500 && cpa > 20000) recomendaciones.push("‚ö†Ô∏è [23] CPM econ√≥mico pero CPA muy alto. ‚öôÔ∏è Segmentaci√≥n poco calificada o landing no convierte.");
if (cpc < 900 && ctr > 3 && roas < 1) recomendaciones.push("üìâ [24] Anuncio atractivo pero no convierte en ventas. ‚öôÔ∏è Revisar producto o p√°gina.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [25] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [26] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [27] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [28] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [29] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [32] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [33] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [34] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [35] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [36] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [39] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [40] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [41] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [42] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [43] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [46] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [47] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [48] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [49] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [50] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [53] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [54] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [55] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [56] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [57] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [60] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [61] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [62] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [63] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [64] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [67] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [68] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [69] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [70] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [71] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [74] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [75] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [76] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [77] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [78] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [81] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [82] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [83] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [84] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [85] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [88] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [89] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [90] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [91] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [92] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (impresiones > 15000 && compras < 3) recomendaciones.push("üìâ [95] Muchas impresiones con pocas compras. ‚öôÔ∏è Cambia el √°ngulo del anuncio o el p√∫blico.");
if (compras > 10 && frecuencia > 5) recomendaciones.push("üìà [96] Compras constantes pero frecuencia alta. üìà Escala con precauci√≥n, considera nuevos creativos.");
if (roas > 4 && compras > 30 && frecuencia < 2.5) recomendaciones.push("üöÄ [97] ROAS excelente, muchas compras y frecuencia baja. Escala agresivamente.");
if (compras > 0 && inicios_de_pago === 0) recomendaciones.push("üîç [98] Hay compras registradas pero sin inicios de pago. ‚öôÔ∏è Posible error de tracking.");
if (alcance > 8000 && ctr < 0.8) recomendaciones.push("üìâ [99] Buen alcance pero bajo CTR. ‚öôÔ∏è Tu anuncio no est√° generando inter√©s. Cambia el enfoque.");
if (frecuencia > 6 && ctr < 0.5) recomendaciones.push("üìâ [101] Alta frecuencia y bajo CTR. ‚ö†Ô∏è El p√∫blico est√° saturado. Renueva tus creativos.");
if (roas < 0.5 && cpa > 20000 && inicios_de_pago < 2) recomendaciones.push("üö® [102] ROAS muy bajo, CPA elevado y pocos inicios. üõë Reestructura la campa√±a.");
if (ctr > 2 && cpa > 20000) recomendaciones.push("‚ö†Ô∏è [103] CTR alto pero CPA muy elevado. ‚öôÔ∏è Anuncio atractivo, pero el funnel no convierte.");
if (valor_de_compras > 100000 && compras < 3) recomendaciones.push("üìâ [104] Alto valor total pero pocas compras. ‚öôÔ∏è Problemas de atribuci√≥n o ticket promedio inusual.");
if (gasto > 80000 && compras < 5) recomendaciones.push("üö® [105] Gasto elevado con muy pocas compras. ‚ùå Pausar o redise√±ar la campa√±a.");
if (frecuencia < 2 && impresiones < 3000 && ctr > 3) recomendaciones.push("üìà [106] Buen CTR con baja exposici√≥n. ‚úÖ Escala progresivamente.");
if (roas > 3 && frecuencia < 2.5 && cpa < 10000) recomendaciones.push("üöÄ [107] ROAS excelente y CPA bajo. ‚úÖ Escala agresivamente.");
if (cpm > 5000 && ctr < 1) recomendaciones.push("üìâ [108] CPM alto con CTR bajo. ‚ö†Ô∏è Creativo no est√° funcionando.");
if (ctr > 4 && cpc < 800 && compras === 0) recomendaciones.push("üîç [109] CTR y CPC √≥ptimos pero sin compras. ‚öôÔ∏è Posible problema en la p√°gina de producto.");
if (compras > 20 && cpa < 12000 && roas > 2) recomendaciones.push("‚úÖ [110] Buen rendimiento. Considera duplicar campa√±a y escalar progresivamente.");
if (inicios_de_pago > 10 && compras === 0) recomendaciones.push("‚ö†Ô∏è [111] Inicios de pago sin compras. ‚öôÔ∏è Posible problema de checkout.");
if (ctr < 0.5 && frecuencia > 4 && cpa > 20000) recomendaciones.push("üìâ [112] Anuncio saturado y mal rendimiento. ‚ùå Pausa o lanza nueva creatividad.");
if (gasto < 30000 && compras > 10 && roas > 2.5) recomendaciones.push("üî• [113] Excelente performance con bajo gasto. ‚úÖ Escala gradualmente.");
if (alcance > 10000 && compras === 0 && ctr < 1) recomendaciones.push("üö® [114] Alcance alto sin resultados. ‚ö†Ô∏è Anuncio irrelevante para el p√∫blico.");
if (impresiones > 20000 && frecuencia < 2 && roas > 4) recomendaciones.push("üöÄ [115] Alto ROAS y poco desgaste. ‚úÖ Escala con confianza.");

if (cpa > 25000 && roas < 1 && frecuencia > 3.5) recomendaciones.push("üö® [117] Rendimiento cr√≠tico. ‚ùå Pausar campa√±a urgente.");
if (inicios_de_pago > 5 && cpa > 20000 && compras < 3) recomendaciones.push("‚ö†Ô∏è [118] Alto inter√©s pero pocas compras. ‚öôÔ∏è Revisa problemas en checkout o confianza.");
if (compras > 15 && valor_de_compras < 50000) recomendaciones.push("üìâ [119] Muchas ventas pero bajo valor. ‚öôÔ∏è Eval√∫a ticket promedio y promoci√≥n.");
if (ctr > 5 && cpc < 700 && compras === 0) recomendaciones.push("üîç [120] Mucho inter√©s sin conversi√≥n. ‚ö†Ô∏è Problemas serios en funnel o confianza.");
if (frecuencia > 6 && roas < 1) recomendaciones.push("üìâ [121] P√∫blico saturado sin retorno. ‚ùå Pausar o cambiar audiencia.");
if (alcance > 20000 && ctr < 0.7) recomendaciones.push("üìâ [122] Buen alcance pero bajo CTR. ‚öôÔ∏è Prueba otro gancho en el anuncio.");
if (cpa < 10000 && compras > 10 && roas > 2) recomendaciones.push("‚úÖ [123] Excelente CPA y rentabilidad. Escala gradualmente.");
if (ctr < 0.5 && inicios_de_pago < 2 && impresiones > 10000) recomendaciones.push("üìâ [124] Muchas impresiones sin inter√©s. ‚ö†Ô∏è Anuncio poco atractivo.");
if (cpm > 4000 && ctr < 1.2) recomendaciones.push("üìâ [125] CPM elevado y bajo CTR. ‚öôÔ∏è Creatividad d√©bil o audiencia no relevante.");
if (cpa < 8000 && roas > 3 && frecuencia < 3) recomendaciones.push("‚úÖ [126] Resultados sobresalientes. Escala con duplicaci√≥n.");
if (compras === 0 && cpm < 1000 && ctr > 2) recomendaciones.push("‚ö†Ô∏è [127] Buen rendimiento en tr√°fico pero sin conversiones. ‚öôÔ∏è Revisa producto o proceso.");
if (gasto > 70000 && valor_de_compras < 30000) recomendaciones.push("üìâ [128] Mala rentabilidad. ‚ö†Ô∏è Pausar y replantear enfoque.");
if (ctr > 3 && roas < 1 && frecuencia > 4) recomendaciones.push("üìâ [129] Anuncio a√∫n genera clics pero no convierte. ‚öôÔ∏è Redirige el tr√°fico o cambia la oferta.");
if (compras > 5 && cpa < 10000 && roas > 1.8) recomendaciones.push("‚úÖ [130] Buena base de rendimiento. Escala progresivamente con presupuesto duplicado.");
if (roas > 2 && frecuencia < 3 && compras > 10) recomendaciones.push("‚úÖ [131] ROAS saludable, baja frecuencia y buen volumen de compras. Escala progresivamente.");
if (cpa > 25000 && roas < 0.8 && inicios_de_pago < 3) recomendaciones.push("üö® [132] CPA cr√≠tico y bajo ROAS sin intenci√≥n de compra. Pausa y replantea oferta.");
if (impresiones > 25000 && ctr < 1 && compras === 0) recomendaciones.push("‚ö†Ô∏è [133] Mucha visibilidad sin resultados. El anuncio no engancha. Redise√±ar mensaje.");
if (cpm < 1000 && ctr > 2 && cpa > 20000) recomendaciones.push("üìâ [134] Buen tr√°fico a bajo costo, pero no rentable. Revisar embudo.");
if (compras > 10 && frecuencia > 6 && roas < 1.2) recomendaciones.push("üìâ [135] A pesar de ventas, alto desgaste y poca rentabilidad. Testear nuevos p√∫blicos.");
if (ctr < 0.5 && frecuencia > 4 && impresiones > 15000) recomendaciones.push("üìâ [136] CTR bajo con desgaste elevado. Anuncio obsoleto.");
if (cpc > 2000 && ctr < 1 && cpa > 20000) recomendaciones.push("üö® [137] Clics costosos, poco inter√©s y nula conversi√≥n. Cortar campa√±a.");
if (valor_de_compras > 200000 && roas > 3 && frecuencia < 2) recomendaciones.push("üöÄ [138] Alto volumen de ventas y ROAS saludable. Escalar agresivamente.");
if (gasto > 60000 && cpa < 10000 && compras > 15) recomendaciones.push("‚úÖ [139] Excelente CPA y volumen. Duplica presupuesto con confianza.");
if (frecuencia > 7 && ctr < 0.5 && roas < 1) recomendaciones.push("üìâ [140] Saturaci√≥n severa sin retorno. Urgente rotar creativos o parar.");
if (cpm > 5000 && compras === 0 && ctr < 0.8) recomendaciones.push("üö® [141] Costo por mil elevado sin resultados. Cortar la campa√±a.");
if (ctr > 4 && cpa < 15000 && roas > 2.5) recomendaciones.push("‚úÖ [142] Muy buen rendimiento. Considera duplicar con nuevo p√∫blico.");
if (compras > 25 && cpa < 12000 && roas > 3) recomendaciones.push("üöÄ [143] Alto volumen con excelentes KPIs. Escalar agresivamente y testear m√°s creativos.");
if (inicios_de_pago > 15 && compras < 3 && roas < 1) recomendaciones.push("‚ö†Ô∏è [144] Mucha intenci√≥n pero no convierte. Revisar confianza, precios o experiencia.");
if (cpc < 800 && ctr > 5 && compras > 0 && roas < 1) recomendaciones.push("üìâ [145] Anuncio efectivo pero no rentable. Revisa oferta/producto.");
if (compras > 20 && roas > 4 && cpa < 10000) recomendaciones.push("‚úÖ [146] KPIs ideales. Duplica presupuesto y testea m√°s p√∫blicos.");
if (gasto > 100000 && roas < 1 && compras < 10) recomendaciones.push("üö® [147] P√©rdidas significativas. Cortar y analizar profundamente.");
if (frecuencia < 2 && cpm < 1500 && roas > 2) recomendaciones.push("‚úÖ [148] Rendimiento √≥ptimo, poco desgaste. Escala manteniendo frecuencia controlada.");
if (ctr < 0.5 && impresiones > 10000 && compras === 0) recomendaciones.push("üìâ [149] Nadie interact√∫a ni compra. Cambiar todo: p√∫blico, anuncio y producto.");
if (cpa < 9000 && compras > 8 && roas > 1.5) recomendaciones.push("‚úÖ [150] Resultados s√≥lidos y sostenibles. Escala progresivamente con nuevos p√∫blicos.");
if (compras > 5 && cpa < 10000 && roas > 2) recomendaciones.push("‚úÖ [151] Buen rendimiento. Considera escalar con p√∫blicos similares.");
if (compras < 3 && inicios_de_pago > 10 && roas < 1) recomendaciones.push("‚ö†Ô∏è [152] Muchas intenciones de compra pero baja conversi√≥n. Revisa confianza en la p√°gina.");
if (frecuencia > 6 && ctr < 1) recomendaciones.push("üìâ [153] Alta frecuencia y poco inter√©s. El anuncio est√° saturado.");
if (ctr > 4 && cpc < 700 && roas < 1) recomendaciones.push("üìâ [154] Muy buen anuncio pero no convierte en ventas. Revisa el producto u oferta.");
if (gasto > 70000 && compras < 5) recomendaciones.push("üö® [155] Gasto excesivo con pocas ventas. Detener campa√±a y reevaluar.");
if (cpa > 25000 && roas < 1 && impresiones > 20000) recomendaciones.push("üö® [156] Mal rendimiento a gran escala. Urgente redise√±o total.");
if (ctr < 0.8 && cpc > 1800 && frecuencia > 4) recomendaciones.push("üìâ [157] Anuncio caro, poco atractivo y desgastado. Cortar.");
if (compras > 15 && roas > 3 && frecuencia < 3) recomendaciones.push("‚úÖ [158] Campa√±a saludable y rentable. Escalar con confianza.");
if (alcance > 10000 && ctr < 0.5) recomendaciones.push("‚ö†Ô∏è [159] Alto alcance sin interacci√≥n. Segmentaci√≥n mal enfocada.");
if (cpm > 6000 && compras < 2) recomendaciones.push("üö® [160] CPM elevad√≠simo sin resultados. Pausar inmediatamente.");
if (inicios_de_pago > 20 && compras === 0) recomendaciones.push("‚ö†Ô∏è [161] Algo impide completar las compras. Revisar embudo.");
if (cpa < 9000 && compras > 20 && roas > 2) recomendaciones.push("‚úÖ [162] Excelente rendimiento. Escalar progresivamente.");
if (compras > 10 && frecuencia > 7) recomendaciones.push("üìâ [163] Buenas ventas, pero est√°s quemando la audiencia. Refresca los creativos.");
if (ctr > 5 && cpc < 600 && roas < 1.5) recomendaciones.push("üìâ [164] Alta interacci√≥n pero retorno bajo. Revisar pricing o confianza.");
if (alcance < 1000 && cpa > 20000) recomendaciones.push("üìâ [165] P√∫blico demasiado peque√±o o mal optimizado. Ampliar targeting.");
if (compras > 30 && roas > 4) recomendaciones.push("üöÄ [166] Campa√±a top. Escalar agresivamente y replicar √°ngulo.");
if (gasto < 20000 && roas > 3 && frecuencia < 2) recomendaciones.push("‚úÖ [167] Testeo inicial muy prometedor. Aumentar inversi√≥n.");
if (ctr < 1 && frecuencia > 5 && cpm > 3000) recomendaciones.push("üìâ [168] Todo indica desgaste severo. Creativo agotado.");
if (roas < 0.5 && cpa > 30000 && cpc > 2000) recomendaciones.push("üö® [169] Todo mal. Pausar y reestructurar por completo.");
if (compras > 5 && cpa < 8000 && roas > 2) recomendaciones.push("‚úÖ [170] Buen control de costos y rendimiento. Escala poco a poco.");
if (impresiones > 30000 && ctr < 0.6 && compras < 3) recomendaciones.push("üìâ [171] Visibilidad sin resultados. Anuncio sin impacto.");
if (cpc > 2500 && ctr < 0.8 && roas < 1) recomendaciones.push("üö® [172] Inversi√≥n mal dirigida. Redirige targeting y creativos.");
if (compras > 12 && cpa >= 10000 && cpa <= 15000 && roas > 1.8)recomendaciones.push("‚úÖ [173] Rendimiento estable. Escalar gradualmente.");
if (inicios_de_pago > 10 && cpa > 20000) recomendaciones.push("‚ö†Ô∏è [174] Usuarios interesados pero CPA muy alto. Optimiza checkout.");
if (frecuencia > 5 && roas < 1.5) { recomendaciones.push("üìâ [175] Saturaci√≥n en curso. Necesitas frescura creativa."); }
if (compras > 8 && roas >= 1.5 && roas <= 2.5) {
  recomendaciones.push("‚úÖ [181] Resultados aceptables. Escalar con ajustes.");
}

if (inicios_de_pago === 0 && cpa > 25000) {
  recomendaciones.push("üö® [182] Sin intenci√≥n de compra y muy caro. No continuar.");
}

if (roas > 3.5 && frecuencia < 2) {
  recomendaciones.push("‚úÖ [183] Alto retorno con poco desgaste. Escalar agresivamente.");
}

if (alcance > 15000 && compras < 5) {
  recomendaciones.push("üìâ [184] Llegas a muchos, pero no conviertes. Cambia propuesta.");
}

if (compras > 15 && cpa < 9000) {
  recomendaciones.push("‚úÖ [185] Excelente costo por compra. Aumentar presupuesto.");
}

if (cpm > 7000 && ctr < 0.5) {
  recomendaciones.push("üö® [186] Mal targeting o ubicaci√≥n. Redirige presupuesto.");
}

if (frecuencia < 2 && ctr > 5 && roas > 3) {
  recomendaciones.push("üöÄ [187] Campa√±a nueva y exitosa. Escala con confianza.");
}

if (inicios_de_pago > 15 && compras === 0 && roas < 1) {
  recomendaciones.push("‚ö†Ô∏è [188] Hay inter√©s, pero algo falla. Mejora experiencia final.");
}

if (cpc < 800 && roas < 1 && compras < 5) {
  recomendaciones.push("üìâ [189] Tr√°fico barato pero sin ventas. Mal producto o embudo.");
}

if (compras > 25 && frecuencia > 4 && roas > 2.5) {
  recomendaciones.push("‚úÖ [190] Escalando sin desgaste. Mant√©n creatividad y duplica p√∫blicos.");
}

if (gasto > 50000 && roas > 2.5 && cpa < 10000) {
  recomendaciones.push("‚úÖ [191] Rendimiento s√≥lido. Justifica inversi√≥n m√°s fuerte.");
}

if (cpa >= 14000 && cpa <= 15000 && roas > 1.8) {
  recomendaciones.push("‚úÖ [192] Aceptable dentro del objetivo. Ajusta segmentaci√≥n para optimizar.");
}

if (frecuencia > 8 && ctr < 0.5) {
  recomendaciones.push("üìâ [193] Agotamiento extremo. Pausar anuncio.");
}

if (ctr < 0.4 && cpc > 2500) {
  recomendaciones.push("üö® [194] Nadie interact√∫a y clics car√≠simos. Creativo ineficiente.");
}

if (cpm < 1000 && roas > 3 && cpa < 9000) {
  recomendaciones.push("‚úÖ [195] Anuncio eficiente en todos los sentidos. Aumentar presupuesto.");
}

if (ctr > 6 && cpc < 500 && roas > 3.5) {
  recomendaciones.push("üöÄ [196] Creativo viral y rentable. Escalar todo.");
}

if (compras === 0 && gasto > 80000) {
  recomendaciones.push("üö® [197] P√©rdida completa. Urge replantear estrategia.");
}

if (cpa > 30000 && ctr < 0.5 && cpc > 2500) {
  recomendaciones.push("üö® [198] Ineficiencia total. Cerrar campa√±a.");
}

if (ctr > 5 && roas >= 2 && roas <= 3 && cpa < 10000) {
  recomendaciones.push("‚úÖ [199] Buen performance. Considera expandir targeting.");
}

if (frecuencia < 1.5 && ctr > 4.5 && cpa < 8000) {
  recomendaciones.push("üöÄ [200] Campa√±a fresca, efectiva y barata. Escalar agresivamente.");
}


  return recomendaciones.length
    ? recomendaciones.map(r => `<li>${r}</li>`).join('')
    : '<li>‚úÖ Rendimiento saludable</li>';
}



async function fetchCampa√±asActivas() {
  try {
    const res = await fetch(sheetCampa√±asUrl);
    const data = (await res.json()).values;

    const headers = data[0];
    const rows = data.slice(1).filter(r => (r[1] || '').toLowerCase() === 'active');

    const contenedor = document.getElementById('campa√±asActivas');
    contenedor.innerHTML = '';

    if (!rows.length) {
      contenedor.innerHTML = '<p style="text-align:center;">No hay campa√±as activas</p>';
      return;
    }

    rows.forEach(r => {
      const valores = headers.map((h, i) => ({ campo: h, valor: r[i] || '' }));
      const recomendaciones = generarRecomendaciones(valores);

      const card = document.createElement('div');
      card.className = 'card';
      card.style.gridColumn = '1 / -1';
      card.innerHTML = `
        <h3>${valores[0].valor}</h3>
        <div class="metrics">
          ${valores.slice(2).map(v => `
            <div class="metric">
              <div class="metric-value">${['CPC','CPM','Gasto','Costo por compra','Valor de compras','Costo por inicio de pago','Costo por landing page'].includes(v.campo) ? formatearCO(v.valor) : v.valor}</div>
              <div>${v.campo}</div>
            </div>
          `).join('')}
        </div>
        <div style="background:#2b3c59; margin-top:15px; padding:12px; border-radius:8px;">
          <strong style="color:#88a91e;">Recomendaciones:</strong>
          <ul style="padding-left:20px; margin-top:6px;">
            ${recomendaciones}
          </ul>
        </div>
      `;
      contenedor.appendChild(card);
    });

  } catch (err) {
    console.error('Error cargando campa√±as activas:', err);
  }
}

fetchCampa√±asActivas();
setInterval(fetchCampa√±asActivas, 180000);
</script>

</body>
</html>
